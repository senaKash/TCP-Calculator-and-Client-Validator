# TCP-Calculator-and-Client-Validator

**TCP Calculator and Client Validator**

Этот набор программ состоит из двух компонентов:

1. **server.cpp** — TCP‑сервер­калькулятор.
2. **client.cpp** — TCP‑клиент­верификатор работы сервера.

---

## Сборка

```bash
# Компиляция сервера
g++ -std=c++17 -O2 server.cpp -o server

# Компиляция клиента
g++ -std=c++17 -O2 client.cpp -o client
```

## Запуск

1. Запустите сервер, указав порт для прослушивания:

   ```bash
   ./server <port>
   # пример:
   ./server 5000
   ```

2. В другом терминале запустите клиента с параметрами:

   * `n` — количество чисел в каждом выражении
   * `connections` — число параллельных TCP­сессий
   * `server_addr` — адрес сервера (IPv4)
   * `server_port` — порт сервера

   ```bash
   ./client <n> <connections> <server_addr> <server_port>
   # пример:
   ./client 10 5 127.0.0.1 5000
   ```

Клиент сгенерирует для каждой сессии случайное арифметическое выражение из `n` чисел, разобьёт его на фрагменты и отправит серверу. После получения ответа клиент сверит его с локальным вычислением и выведет:

* `Match! Expr: ..., Result: ...` — если ответ совпал.
* `Mismatch! Expr: ..., Server: ..., Expected: ...` — если есть расхождение.

---

## Архитектура и особенности

* **Протокол**: текстовые арифметические выражения без пробелов внутри, разделённые пробелом (`' '`). Ответы передаются тем же способом.
* **I/O**: оба приложения используют неблокирующие сокеты и `epoll` (edge‑triggered) для эффективного обслуживания большого числа соединений без потоков.
* **Обработка ошибок**:

  * Сервер при делении на ноль или синтаксической ошибке отвечает `ERR `.
  * Клиент при `ERR` считает это несоответствием.

---

## Примечания

* Код написан на C++17.
* Можно настраивать число одновременных сессий и длину выражений для нагрузочного тестирования
* В сервере используется `std::unordered_map<int, Connection>` для динамического хранения буферов по `fd`

---

© 2025 
